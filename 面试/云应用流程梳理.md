# 云应用流程梳理

> 简单介绍下云应用：   可以使用浏览器打开一个应用，就如同在本地机器打开一个软件一样。比如本地没有安装Word软件，开发浏览器，就可以直接使用
>
> 由云应用提供的所有软件。主要的原理，在云服务器上打开应用，通过音视频传输以及鼠标键盘事件的解析，让远端的应用有着和本地需要安装的应用几乎一样的使用体验。



```xml
以打开一个云应用为例：
1. 用户通过用户名或者手机号登录JAVA后台系统，进行用户身份认证，认证通过后，给B端颁发令牌
2. B端携带有效令牌，访问可用的云上APP列表，JAVA获取返回属于当前用户可用的云APP列表
3. 客户双击某个APP，B端首先带着这个APP的镜像ID，调用JAVA后端接口，JAVA端接收到请求后，会调用由C++开发的服务appMgr，
4. appMgr返回AppInfo信息，紧接着，JAVA程序这个时候会带着AppInfo信息和当前用户的挂盘信息调用由C++开发的daemon，
   daemon负责和真实应用交互，它返回mcuInfo信息，这个包含了需要建立长连接的必要参数。
5. 经过上面的流程，前端拿到mcuInfo信息之后，与proxy服务建立长连接，proxy发送指令给daemon，daemon在云端启动应用，mcu会应用的运行时产生的音视频数据编码    后，以一定的帧率传送给B端。
6. B端对mcu传过来的数据进行解码，渲染等操作，同时还会把鼠标，键盘等的事件传送给proxy，proxy对这些事件进行转换，
   最后交给daemon,操作启动在虚拟机上的app应用。
   proxy是一个由C++开发的，底层的一个调度器。它负责和mcu,daemon交互。mcu是服务音视频编码，以及鼠标键盘事件解析的。daemon直接和真实的运行的app交互。
在这个应用打开的过程中，JAVA服务，类似是一个中央调度器，协调B端与底层的C++程序建立一个有效的连接。
应用和客户，应用与组织的关系维护，应用的发布，排版，样式等都是由Java后台服务管理。
   整个JAVA后台，根据功能的划分，主要微服务有UserService（人员管理，公司组织架构管理）,ApplicationSerive，云空间，日程，企业网盘等。


疫情期间，为公司开发的一些疫情防控相关的多种应用提供统一的入口，独立开发的组织架构管理服务，包含用户管理、组织架构管理。
```

